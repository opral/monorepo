<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Zettel Spec - ProseMirror Editor</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<!-- Basic ProseMirror styles -->
		<link rel="stylesheet" href="https://prosemirror.net/css/editor.css" />
		<style>
			body {
				font-family: system-ui, sans-serif;
				margin: 2rem;
				background: #fafbfc;
			}
			/* Style the editor */
			.ProseMirror {
				position: relative;
				word-wrap: break-word;
				white-space: pre-wrap;
				white-space: break-spaces;
				-webkit-font-variant-ligatures: none;
				font-variant-ligatures: none;
				font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
				outline: none;
				border: 1px solid #ccc;
				padding: 1rem;
				min-height: 150px;
				background: #fff;
			}

			.ProseMirror p:first-child,
			.ProseMirror h1:first-child,
			.ProseMirror h2:first-child,
			.ProseMirror h3:first-child,
			.ProseMirror h4:first-child,
			.ProseMirror h5:first-child,
			.ProseMirror h6:first-child {
				margin-top: 10px;
			}

			.ProseMirror-focused {
				border-color: black;
			}

			/* Style the state display area */
			#prosemirror-state-display {
				width: 100%;
				margin-top: 1rem;
				font-family: monospace;
				font-size: 12px;
				box-sizing: border-box;
				min-height: 100px;
				background: #f0f0f0;
				border: 1px solid #ccc;
				padding: 0.5rem;
				resize: vertical; /* Allow vertical resize */
			}
		</style>
	</head>
	<body>
		<h1>Zettel Spec - ProseMirror Editor</h1>
		<div id="editor"></div>

		<h2>ProseMirror Document State (JSON)</h2>
		<textarea id="prosemirror-state-display" readonly></textarea>

		<script type="module">
			import { Editor } from "@tiptap/core";
			import { ZettelExtensions } from "./src/extensions.js";

			const stateTextarea = document.getElementById("prosemirror-state-display");

			function updateStateDisplay(json) {
				stateTextarea.value = JSON.stringify(json, null, 2);
				autoResizeTextarea(stateTextarea);
			}

			function autoResizeTextarea(textarea) {
				textarea.style.height = "auto";
				textarea.style.height = textarea.scrollHeight + "px";
			}

			const editor = new Editor({
				element: document.querySelector("#editor"),
				extensions: ZettelExtensions,
				onUpdate: ({ editor }) => {
					updateStateDisplay(editor.getJSON());
				},
			});

			// Initial state display
			updateStateDisplay(editor.getJSON());
		</script>
	</body>
</html>
