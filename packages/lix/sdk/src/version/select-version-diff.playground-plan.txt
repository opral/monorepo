-- original SQL --
select * from (
WITH
  -- Source side should expose explicit deletions (tombstones)
  -- Use state_with_tombstones to include rows with NULL snapshot_content
  s AS (
    SELECT entity_id, schema_key, file_id, change_id, commit_id, version_id, snapshot_content
    FROM state_with_tombstones
    WHERE version_id = '01920000-0000-7000-8000-000000000026'
  ),
  t AS (
    SELECT entity_id, schema_key, file_id, change_id, commit_id, version_id
    FROM state_by_version
    WHERE version_id = '01920000-0000-7000-8000-000000000044'
  ),
  joined AS (
    SELECT
      COALESCE(s.entity_id, t.entity_id) AS entity_id,
      COALESCE(s.schema_key, t.schema_key) AS schema_key,
      COALESCE(s.file_id, t.file_id) AS file_id,
      t.version_id AS before_version_id,
      t.change_id AS before_change_id,
      t.commit_id AS before_commit_id,
      s.version_id AS after_version_id,
      s.change_id AS after_change_id,
      s.commit_id AS after_commit_id,
      CASE
        -- Explicit delete in source (tombstone takes precedence)
        WHEN s.snapshot_content IS NULL THEN 'removed'
        -- Added in source only (live row)
        WHEN t.change_id IS NULL AND s.snapshot_content IS NOT NULL THEN 'added'
        -- Both present and different (live row in source)
        WHEN t.change_id IS NOT NULL AND s.snapshot_content IS NOT NULL AND s.change_id != t.change_id THEN 'modified'
        -- Both present and same (live row in source)
        ELSE 'unchanged'
      END AS status
    FROM s
    LEFT JOIN t ON t.entity_id = s.entity_id AND t.schema_key = s.schema_key AND t.file_id = s.file_id
    UNION ALL
    SELECT
      COALESCE(s.entity_id, t.entity_id) AS entity_id,
      COALESCE(s.schema_key, t.schema_key) AS schema_key,
      COALESCE(s.file_id, t.file_id) AS file_id,
      t.version_id AS before_version_id,
      t.change_id AS before_change_id,
      t.commit_id AS before_commit_id,
      -- For target-only rows (no source contribution), mirror target values for after_*
      -- This represents entities that exist in target but were never in source
      t.version_id AS after_version_id,
      t.change_id AS after_change_id,
      t.commit_id AS after_commit_id,
      CASE
        -- Target-only: entity exists in target but never existed in source (no explicit delete)
        -- Treated as unchanged since source doesn't modify it
        WHEN s.change_id IS NULL AND t.change_id IS NOT NULL THEN 'unchanged'
        ELSE 'unchanged'
      END AS status
    FROM t
    LEFT JOIN s ON s.entity_id = t.entity_id AND s.schema_key = t.schema_key AND s.file_id = t.file_id
    WHERE s.change_id IS NULL
  )
SELECT *
FROM joined
    ) as "diff" where "diff"."status" != ?

-- rewritten SQL --
SELECT *
FROM (WITH s AS (
  SELECT
    entity_id,
    schema_key,
    file_id,
    change_id,
    commit_id,
    version_id,
    snapshot_content
  FROM (SELECT
    entity_id,
    schema_key,
    file_id,
    version_id,
    plugin_key,
    snapshot_content,
    schema_version,
    created_at,
    updated_at,
    inherited_from_version_id,
    change_id,
    untracked,
    commit_id,
    writer_key,
    (SELECT json(metadata)
  FROM (SELECT
    c.id,
    c.entity_id,
    c.schema_key,
    c.schema_version,
    c.file_id,
    c.plugin_key,
    json(c.metadata) AS metadata,
    c.created_at,
    json(s.content) AS snapshot_content
  FROM lix_internal_change AS c LEFT JOIN lix_internal_snapshot AS s ON s.id = c.snapshot_id
  UNION ALL
  SELECT
    t.id,
    t.entity_id,
    t.schema_key,
    t.schema_version,
    t.file_id,
    t.plugin_key,
    json(t.metadata) AS metadata,
    t.created_at,
    json(t.snapshot_content) AS snapshot_content
  FROM lix_internal_transaction_state AS t
  WHERE t.untracked = 0) AS change
  WHERE change.id = lix_internal_state_vtable.change_id) AS metadata
  FROM (
  WITH
    wanted_versions AS (
      SELECT '01920000-0000-7000-8000-000000000026' AS version_id
    )
  SELECT
    w."entity_id" AS "entity_id",
    w."schema_key" AS "schema_key",
    w."file_id" AS "file_id",
    w."plugin_key" AS "plugin_key",
    w."snapshot_content" AS "snapshot_content",
    w."schema_version" AS "schema_version",
    w."version_id" AS "version_id",
    w."created_at" AS "created_at",
    w."updated_at" AS "updated_at",
    w."inherited_from_version_id" AS "inherited_from_version_id",
    w."change_id" AS "change_id",
    w."untracked" AS "untracked",
    w."commit_id" AS "commit_id",
    w."metadata" AS "metadata",
    COALESCE(ws_dst.writer_key, ws_src.writer_key, w.writer_key) AS "writer_key"
  FROM (
    SELECT
      c.entity_id AS entity_id,
      c.schema_key AS schema_key,
      c.file_id AS file_id,
      c.plugin_key AS plugin_key,
      c.snapshot_content AS snapshot_content,
      c.schema_version AS schema_version,
      c.version_id AS version_id,
      c.created_at AS created_at,
      c.updated_at AS updated_at,
      c.inherited_from_version_id AS inherited_from_version_id,
      c.change_id AS change_id,
      c.untracked AS untracked,
      c.commit_id AS commit_id,
      c.metadata AS metadata,
      c.writer_key AS writer_key,
      c.priority AS priority,
      ROW_NUMBER() OVER (
              PARTITION BY c.file_id, c.schema_key, c.entity_id, c.version_id
              ORDER BY c.priority, c.created_at DESC, c.file_id, c.schema_key, c.entity_id, c.version_id, c.change_id
            ) AS rn
    FROM (
        SELECT
          unt.entity_id AS entity_id,
          unt.schema_key AS schema_key,
          unt.file_id AS file_id,
          unt.plugin_key AS plugin_key,
          json(unt.snapshot_content) AS snapshot_content,
          unt.schema_version AS schema_version,
          unt.version_id AS version_id,
          unt.created_at AS created_at,
          unt.updated_at AS updated_at,
          NULL AS inherited_from_version_id,
          'untracked' AS change_id,
          1 AS untracked,
          'untracked' AS commit_id,
          NULL AS metadata,
          NULL AS writer_key,
          2 AS priority
        FROM lix_internal_state_all_untracked unt
        JOIN wanted_versions wv_unt ON wv_unt.version_id = unt.version_id

            UNION ALL

        		SELECT
            cache.entity_id AS entity_id,
            cache.schema_key AS schema_key,
            cache.file_id AS file_id,
            cache.plugin_key AS plugin_key,
            json(cache.snapshot_content) AS snapshot_content,
            cache.schema_version AS schema_version,
            cache.version_id AS version_id,
            cache.created_at AS created_at,
            cache.updated_at AS updated_at,
            cache.inherited_from_version_id AS inherited_from_version_id,
            cache.change_id AS change_id,
            0 AS untracked,
            cache.commit_id AS commit_id,
            NULL AS metadata,
            NULL AS writer_key,
            3 AS priority
        		FROM (SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_version_descriptor"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_stored_schema"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_key_value"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_active_account"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_commit"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_commit_edge"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_version_tip"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_change_set"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_change_set_element"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_label"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_test_bench_diff_entity") cache
        		JOIN wanted_versions wv_cache ON wv_cache.version_id = cache.version_id

            UNION ALL

        		SELECT
            cache.entity_id AS entity_id,
            cache.schema_key AS schema_key,
            cache.file_id AS file_id,
            cache.plugin_key AS plugin_key,
            json(cache.snapshot_content) AS snapshot_content,
            cache.schema_version AS schema_version,
            vi.version_id AS version_id,
            cache.created_at AS created_at,
            cache.updated_at AS updated_at,
            cache.version_id AS inherited_from_version_id,
            cache.change_id AS change_id,
            0 AS untracked,
            cache.commit_id AS commit_id,
            NULL AS metadata,
            NULL AS writer_key,
            4 AS priority
        		FROM (
        SELECT '01920000-0000-7000-8000-000000000026' AS version_id, 'global' AS ancestor_version_id
        ) AS vi
        		JOIN wanted_versions wv_vi ON wv_vi.version_id = vi.version_id
        		JOIN (SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_version_descriptor"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_stored_schema"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_key_value"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_active_account"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_commit"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_commit_edge"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_version_tip"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_change_set"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_change_set_element"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_label"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_test_bench_diff_entity") cache ON cache.version_id = vi.ancestor_version_id
        		WHERE cache.is_tombstone = 0
        		  AND cache.snapshot_content IS NOT NULL

            UNION ALL

        		SELECT
            unt.entity_id AS entity_id,
            unt.schema_key AS schema_key,
            unt.file_id AS file_id,
            unt.plugin_key AS plugin_key,
            json(unt.snapshot_content) AS snapshot_content,
            unt.schema_version AS schema_version,
            vi.version_id AS version_id,
            unt.created_at AS created_at,
            unt.updated_at AS updated_at,
            unt.version_id AS inherited_from_version_id,
            'untracked' AS change_id,
            1 AS untracked,
            'untracked' AS commit_id,
            NULL AS metadata,
            NULL AS writer_key,
            5 AS priority
        		FROM (
        SELECT '01920000-0000-7000-8000-000000000026' AS version_id, 'global' AS ancestor_version_id
        ) AS vi
        		JOIN wanted_versions wv_vi ON wv_vi.version_id = vi.version_id
        		JOIN lix_internal_state_all_untracked unt ON unt.version_id = vi.ancestor_version_id
        		WHERE unt.is_tombstone = 0
        		  AND unt.snapshot_content IS NOT NULL
    ) AS c
  ) AS w

  LEFT JOIN lix_internal_state_writer ws_dst ON
    ws_dst.file_id = w.file_id AND
    ws_dst.entity_id = w.entity_id AND
    ws_dst.schema_key = w.schema_key AND
    ws_dst.version_id = w.version_id
  LEFT JOIN lix_internal_state_writer ws_src ON
    ws_src.file_id = w.file_id AND
    ws_src.entity_id = w.entity_id AND
    ws_src.schema_key = w.schema_key AND
    ws_src.version_id = w.inherited_from_version_id

  LEFT JOIN lix_internal_change chc ON chc.id = w.change_id

  WHERE w.rn = 1
  ) AS "lix_internal_state_vtable") AS state_with_tombstones
  WHERE version_id = '01920000-0000-7000-8000-000000000026'
),
t AS (
  SELECT
    entity_id,
    schema_key,
    file_id,
    change_id,
    commit_id,
    version_id
  FROM (SELECT
    entity_id,
    schema_key,
    file_id,
    version_id,
    plugin_key,
    snapshot_content,
    schema_version,
    created_at,
    updated_at,
    inherited_from_version_id,
    change_id,
    untracked,
    commit_id,
    writer_key,
    (SELECT json(metadata)
  FROM (SELECT
    c.id,
    c.entity_id,
    c.schema_key,
    c.schema_version,
    c.file_id,
    c.plugin_key,
    json(c.metadata) AS metadata,
    c.created_at,
    json(s.content) AS snapshot_content
  FROM lix_internal_change AS c LEFT JOIN lix_internal_snapshot AS s ON s.id = c.snapshot_id
  UNION ALL
  SELECT
    t.id,
    t.entity_id,
    t.schema_key,
    t.schema_version,
    t.file_id,
    t.plugin_key,
    json(t.metadata) AS metadata,
    t.created_at,
    json(t.snapshot_content) AS snapshot_content
  FROM lix_internal_transaction_state AS t
  WHERE t.untracked = 0) AS change
  WHERE change.id = lix_internal_state_vtable.change_id) AS metadata
  FROM (
  WITH
    wanted_versions AS (
      SELECT '01920000-0000-7000-8000-000000000044' AS version_id
    )
  SELECT
    w."entity_id" AS "entity_id",
    w."schema_key" AS "schema_key",
    w."file_id" AS "file_id",
    w."plugin_key" AS "plugin_key",
    w."snapshot_content" AS "snapshot_content",
    w."schema_version" AS "schema_version",
    w."version_id" AS "version_id",
    w."created_at" AS "created_at",
    w."updated_at" AS "updated_at",
    w."inherited_from_version_id" AS "inherited_from_version_id",
    w."change_id" AS "change_id",
    w."untracked" AS "untracked",
    w."commit_id" AS "commit_id",
    w."metadata" AS "metadata",
    COALESCE(ws_dst.writer_key, ws_src.writer_key, w.writer_key) AS "writer_key"
  FROM (
    SELECT
      c.entity_id AS entity_id,
      c.schema_key AS schema_key,
      c.file_id AS file_id,
      c.plugin_key AS plugin_key,
      c.snapshot_content AS snapshot_content,
      c.schema_version AS schema_version,
      c.version_id AS version_id,
      c.created_at AS created_at,
      c.updated_at AS updated_at,
      c.inherited_from_version_id AS inherited_from_version_id,
      c.change_id AS change_id,
      c.untracked AS untracked,
      c.commit_id AS commit_id,
      c.metadata AS metadata,
      c.writer_key AS writer_key,
      c.priority AS priority,
      ROW_NUMBER() OVER (
              PARTITION BY c.file_id, c.schema_key, c.entity_id, c.version_id
              ORDER BY c.priority, c.created_at DESC, c.file_id, c.schema_key, c.entity_id, c.version_id, c.change_id
            ) AS rn
    FROM (
        SELECT
          unt.entity_id AS entity_id,
          unt.schema_key AS schema_key,
          unt.file_id AS file_id,
          unt.plugin_key AS plugin_key,
          json(unt.snapshot_content) AS snapshot_content,
          unt.schema_version AS schema_version,
          unt.version_id AS version_id,
          unt.created_at AS created_at,
          unt.updated_at AS updated_at,
          NULL AS inherited_from_version_id,
          'untracked' AS change_id,
          1 AS untracked,
          'untracked' AS commit_id,
          NULL AS metadata,
          NULL AS writer_key,
          2 AS priority
        FROM lix_internal_state_all_untracked unt
        JOIN wanted_versions wv_unt ON wv_unt.version_id = unt.version_id

            UNION ALL

        		SELECT
            cache.entity_id AS entity_id,
            cache.schema_key AS schema_key,
            cache.file_id AS file_id,
            cache.plugin_key AS plugin_key,
            json(cache.snapshot_content) AS snapshot_content,
            cache.schema_version AS schema_version,
            cache.version_id AS version_id,
            cache.created_at AS created_at,
            cache.updated_at AS updated_at,
            cache.inherited_from_version_id AS inherited_from_version_id,
            cache.change_id AS change_id,
            0 AS untracked,
            cache.commit_id AS commit_id,
            NULL AS metadata,
            NULL AS writer_key,
            3 AS priority
        		FROM (SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_version_descriptor"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_stored_schema"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_key_value"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_active_account"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_commit"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_commit_edge"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_version_tip"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_change_set"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_change_set_element"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_label"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_test_bench_diff_entity") cache
        		JOIN wanted_versions wv_cache ON wv_cache.version_id = cache.version_id

            UNION ALL

        		SELECT
            cache.entity_id AS entity_id,
            cache.schema_key AS schema_key,
            cache.file_id AS file_id,
            cache.plugin_key AS plugin_key,
            json(cache.snapshot_content) AS snapshot_content,
            cache.schema_version AS schema_version,
            vi.version_id AS version_id,
            cache.created_at AS created_at,
            cache.updated_at AS updated_at,
            cache.version_id AS inherited_from_version_id,
            cache.change_id AS change_id,
            0 AS untracked,
            cache.commit_id AS commit_id,
            NULL AS metadata,
            NULL AS writer_key,
            4 AS priority
        		FROM (
        SELECT '01920000-0000-7000-8000-000000000044' AS version_id, 'global' AS ancestor_version_id
        ) AS vi
        		JOIN wanted_versions wv_vi ON wv_vi.version_id = vi.version_id
        		JOIN (SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_version_descriptor"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_stored_schema"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_key_value"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_active_account"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_commit"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_commit_edge"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_version_tip"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_change_set"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_change_set_element"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_lix_label"
        UNION ALL
        SELECT
            "entity_id",
            "schema_key",
            "file_id",
            "plugin_key",
            "snapshot_content",
            "schema_version",
            "version_id",
            "created_at",
            "updated_at",
            "inherited_from_version_id",
            "change_id",
            "commit_id",
            "is_tombstone"
          FROM "lix_internal_state_cache_v1_test_bench_diff_entity") cache ON cache.version_id = vi.ancestor_version_id
        		WHERE cache.is_tombstone = 0
        		  AND cache.snapshot_content IS NOT NULL

            UNION ALL

        		SELECT
            unt.entity_id AS entity_id,
            unt.schema_key AS schema_key,
            unt.file_id AS file_id,
            unt.plugin_key AS plugin_key,
            json(unt.snapshot_content) AS snapshot_content,
            unt.schema_version AS schema_version,
            vi.version_id AS version_id,
            unt.created_at AS created_at,
            unt.updated_at AS updated_at,
            unt.version_id AS inherited_from_version_id,
            'untracked' AS change_id,
            1 AS untracked,
            'untracked' AS commit_id,
            NULL AS metadata,
            NULL AS writer_key,
            5 AS priority
        		FROM (
        SELECT '01920000-0000-7000-8000-000000000044' AS version_id, 'global' AS ancestor_version_id
        ) AS vi
        		JOIN wanted_versions wv_vi ON wv_vi.version_id = vi.version_id
        		JOIN lix_internal_state_all_untracked unt ON unt.version_id = vi.ancestor_version_id
        		WHERE unt.is_tombstone = 0
        		  AND unt.snapshot_content IS NOT NULL
    ) AS c
  ) AS w

  LEFT JOIN lix_internal_state_writer ws_dst ON
    ws_dst.file_id = w.file_id AND
    ws_dst.entity_id = w.entity_id AND
    ws_dst.schema_key = w.schema_key AND
    ws_dst.version_id = w.version_id
  LEFT JOIN lix_internal_state_writer ws_src ON
    ws_src.file_id = w.file_id AND
    ws_src.entity_id = w.entity_id AND
    ws_src.schema_key = w.schema_key AND
    ws_src.version_id = w.inherited_from_version_id

  LEFT JOIN lix_internal_change chc ON chc.id = w.change_id

  WHERE w.rn = 1
  ) AS "lix_internal_state_vtable"
  WHERE snapshot_content IS NOT NULL) AS state_by_version
  WHERE version_id = '01920000-0000-7000-8000-000000000044'
),
joined AS (
  SELECT
    COALESCE(s.entity_id, t.entity_id) AS entity_id,
    COALESCE(s.schema_key, t.schema_key) AS schema_key,
    COALESCE(s.file_id, t.file_id) AS file_id,
    t.version_id AS before_version_id,
    t.change_id AS before_change_id,
    t.commit_id AS before_commit_id,
    s.version_id AS after_version_id,
    s.change_id AS after_change_id,
    s.commit_id AS after_commit_id,
    CASE WHEN s.snapshot_content IS NULL THEN 'removed' WHEN t.change_id IS NULL AND s.snapshot_content IS NOT NULL THEN 'added' WHEN t.change_id IS NOT NULL AND s.snapshot_content IS NOT NULL AND s.change_id != t.change_id THEN 'modified' ELSE 'unchanged' END AS status
  FROM s LEFT JOIN t ON t.entity_id = s.entity_id AND t.schema_key = s.schema_key AND t.file_id = s.file_id
  UNION ALL
  SELECT
    COALESCE(s.entity_id, t.entity_id) AS entity_id,
    COALESCE(s.schema_key, t.schema_key) AS schema_key,
    COALESCE(s.file_id, t.file_id) AS file_id,
    t.version_id AS before_version_id,
    t.change_id AS before_change_id,
    t.commit_id AS before_commit_id,
    t.version_id AS after_version_id,
    t.change_id AS after_change_id,
    t.commit_id AS after_commit_id,
    CASE WHEN s.change_id IS NULL AND t.change_id IS NOT NULL THEN 'unchanged' ELSE 'unchanged' END AS status
  FROM t LEFT JOIN s ON s.entity_id = t.entity_id AND s.schema_key = t.schema_key AND s.file_id = t.file_id
  WHERE s.change_id IS NULL
)
SELECT *
FROM joined) AS "diff"
WHERE "diff"."status" != ?

-- plan --
[
  {
    "id": 1,
    "parent": 0,
    "notused": 0,
    "detail": "COMPOUND QUERY"
  },
  {
    "id": 2,
    "parent": 1,
    "notused": 0,
    "detail": "LEFT-MOST SUBQUERY"
  },
  {
    "id": 4,
    "parent": 2,
    "notused": 0,
    "detail": "CO-ROUTINE w"
  },
  {
    "id": 7,
    "parent": 4,
    "notused": 0,
    "detail": "CO-ROUTINE (subquery-78)"
  },
  {
    "id": 9,
    "parent": 7,
    "notused": 0,
    "detail": "CO-ROUTINE c"
  },
  {
    "id": 10,
    "parent": 9,
    "notused": 0,
    "detail": "COMPOUND QUERY"
  },
  {
    "id": 11,
    "parent": 10,
    "notused": 0,
    "detail": "LEFT-MOST SUBQUERY"
  },
  {
    "id": 14,
    "parent": 11,
    "notused": 0,
    "detail": "MATERIALIZE wanted_versions"
  },
  {
    "id": 16,
    "parent": 14,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 26,
    "parent": 11,
    "notused": 16,
    "detail": "SCAN wv_unt"
  },
  {
    "id": 32,
    "parent": 11,
    "notused": 61,
    "detail": "SEARCH unt USING INDEX idx_lix_internal_state_all_untracked_version_id (version_id=?)"
  },
  {
    "id": 57,
    "parent": 10,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 58,
    "parent": 57,
    "notused": 0,
    "detail": "COMPOUND QUERY"
  },
  {
    "id": 59,
    "parent": 58,
    "notused": 0,
    "detail": "LEFT-MOST SUBQUERY"
  },
  {
    "id": 64,
    "parent": 59,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 70,
    "parent": 59,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_descriptor USING INDEX idx_lix_internal_state_cache_v1_lix_version_descriptor_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 98,
    "parent": 58,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 103,
    "parent": 98,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 109,
    "parent": 98,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_stored_schema USING INDEX idx_lix_internal_state_cache_v1_lix_stored_schema_pk_version_id_json_extract_snapsho_json_extract_snapsho_r7zrf9 (version_id=?)"
  },
  {
    "id": 137,
    "parent": 58,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 142,
    "parent": 137,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 148,
    "parent": 137,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_key_value USING INDEX idx_lix_internal_state_cache_v1_lix_key_value_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 176,
    "parent": 58,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 181,
    "parent": 176,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 187,
    "parent": 176,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_active_account USING INDEX idx_lix_internal_state_cache_v1_lix_active_account_foreign_version_id_inherited_from_versi_json_extract_snapsho_79rox8 (version_id=?)"
  },
  {
    "id": 215,
    "parent": 58,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 220,
    "parent": 215,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 226,
    "parent": 215,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit USING INDEX idx_lix_internal_state_cache_v1_lix_commit_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 254,
    "parent": 58,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 259,
    "parent": 254,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 265,
    "parent": 254,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit_edge USING INDEX idx_lix_internal_state_cache_v1_lix_commit_edge_foreign_version_id_inherited_from_versi_json_extract_snapsho_79rox8 (version_id=?)"
  },
  {
    "id": 293,
    "parent": 58,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 298,
    "parent": 293,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 304,
    "parent": 293,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_tip USING INDEX idx_lix_internal_state_cache_v1_lix_version_tip_unique_version_id_json_extract_snapsho_c3jqlx (version_id=?)"
  },
  {
    "id": 332,
    "parent": 58,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 337,
    "parent": 332,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 343,
    "parent": 332,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 371,
    "parent": 58,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 376,
    "parent": 371,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 382,
    "parent": 371,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set_element USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_element_foreign_version_id_inherited_from_versi_json_extract_snapsho_79rox8 (version_id=?)"
  },
  {
    "id": 410,
    "parent": 58,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 415,
    "parent": 410,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 421,
    "parent": 410,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_label USING INDEX idx_lix_internal_state_cache_v1_lix_label_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 449,
    "parent": 58,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 454,
    "parent": 449,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 460,
    "parent": 449,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_test_bench_diff_entity USING INDEX idx_lix_internal_state_cache_v1_test_bench_diff_entity_vfe (version_id=?)"
  },
  {
    "id": 488,
    "parent": 58,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 489,
    "parent": 488,
    "notused": 0,
    "detail": "COMPOUND QUERY"
  },
  {
    "id": 490,
    "parent": 489,
    "notused": 0,
    "detail": "LEFT-MOST SUBQUERY"
  },
  {
    "id": 492,
    "parent": 490,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 493,
    "parent": 492,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 503,
    "parent": 490,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 508,
    "parent": 490,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_descriptor USING INDEX idx_lix_internal_state_cache_v1_lix_version_descriptor_live_vfe (version_id=?)"
  },
  {
    "id": 518,
    "parent": 490,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 544,
    "parent": 489,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 546,
    "parent": 544,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 547,
    "parent": 546,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 557,
    "parent": 544,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 562,
    "parent": 544,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_stored_schema USING INDEX idx_lix_internal_state_cache_v1_lix_stored_schema_live_vfe (version_id=?)"
  },
  {
    "id": 572,
    "parent": 544,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 598,
    "parent": 489,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 600,
    "parent": 598,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 601,
    "parent": 600,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 611,
    "parent": 598,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 616,
    "parent": 598,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_key_value USING INDEX idx_lix_internal_state_cache_v1_lix_key_value_live_vfe (version_id=?)"
  },
  {
    "id": 626,
    "parent": 598,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 652,
    "parent": 489,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 654,
    "parent": 652,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 655,
    "parent": 654,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 665,
    "parent": 652,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 670,
    "parent": 652,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_active_account USING INDEX idx_lix_internal_state_cache_v1_lix_active_account_live_vfe (version_id=?)"
  },
  {
    "id": 680,
    "parent": 652,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 706,
    "parent": 489,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 708,
    "parent": 706,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 709,
    "parent": 708,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 719,
    "parent": 706,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 724,
    "parent": 706,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit USING INDEX idx_lix_internal_state_cache_v1_lix_commit_live_vfe (version_id=?)"
  },
  {
    "id": 734,
    "parent": 706,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 760,
    "parent": 489,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 762,
    "parent": 760,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 763,
    "parent": 762,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 773,
    "parent": 760,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 778,
    "parent": 760,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit_edge USING INDEX idx_lix_internal_state_cache_v1_lix_commit_edge_live_vfe (version_id=?)"
  },
  {
    "id": 788,
    "parent": 760,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 814,
    "parent": 489,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 816,
    "parent": 814,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 817,
    "parent": 816,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 827,
    "parent": 814,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 832,
    "parent": 814,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_tip USING INDEX idx_lix_internal_state_cache_v1_lix_version_tip_live_vfe (version_id=?)"
  },
  {
    "id": 842,
    "parent": 814,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 868,
    "parent": 489,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 870,
    "parent": 868,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 871,
    "parent": 870,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 881,
    "parent": 868,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 886,
    "parent": 868,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_live_vfe (version_id=?)"
  },
  {
    "id": 896,
    "parent": 868,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 922,
    "parent": 489,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 924,
    "parent": 922,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 925,
    "parent": 924,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 935,
    "parent": 922,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 940,
    "parent": 922,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set_element USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_element_live_vfe (version_id=?)"
  },
  {
    "id": 950,
    "parent": 922,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 976,
    "parent": 489,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 978,
    "parent": 976,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 979,
    "parent": 978,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 989,
    "parent": 976,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 994,
    "parent": 976,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_label USING INDEX idx_lix_internal_state_cache_v1_lix_label_live_vfe (version_id=?)"
  },
  {
    "id": 1004,
    "parent": 976,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 1030,
    "parent": 489,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1032,
    "parent": 1030,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 1033,
    "parent": 1032,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 1043,
    "parent": 1030,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 1048,
    "parent": 1030,
    "notused": 24,
    "detail": "SEARCH lix_internal_state_cache_v1_test_bench_diff_entity USING INDEX idx_lix_internal_state_cache_v1_test_bench_diff_entity_live_vfe (version_id=?)"
  },
  {
    "id": 1058,
    "parent": 1030,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 1084,
    "parent": 489,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1086,
    "parent": 1084,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 1087,
    "parent": 1086,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 1097,
    "parent": 1084,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 1102,
    "parent": 1084,
    "notused": 61,
    "detail": "SEARCH unt USING INDEX idx_lix_internal_state_all_untracked_version_id (version_id=?)"
  },
  {
    "id": 1115,
    "parent": 1084,
    "notused": 0,
    "detail": "BLOOM FILTER ON wv_vi (version_id=?)"
  },
  {
    "id": 1127,
    "parent": 1084,
    "notused": 53,
    "detail": "SEARCH wv_vi USING AUTOMATIC PARTIAL COVERING INDEX (version_id=?)"
  },
  {
    "id": 1156,
    "parent": 58,
    "notused": 263,
    "detail": "SCAN c"
  },
  {
    "id": 1195,
    "parent": 58,
    "notused": 0,
    "detail": "USE TEMP B-TREE FOR ORDER BY"
  },
  {
    "id": 1235,
    "parent": 57,
    "notused": 243,
    "detail": "SCAN (subquery-78)"
  },
  {
    "id": 1319,
    "parent": 10,
    "notused": 0,
    "detail": "MATERIALIZE lix_internal_state_vtable"
  },
  {
    "id": 1321,
    "parent": 1319,
    "notused": 0,
    "detail": "CO-ROUTINE w"
  },
  {
    "id": 1324,
    "parent": 1321,
    "notused": 0,
    "detail": "CO-ROUTINE (subquery-99)"
  },
  {
    "id": 1326,
    "parent": 1324,
    "notused": 0,
    "detail": "CO-ROUTINE c"
  },
  {
    "id": 1327,
    "parent": 1326,
    "notused": 0,
    "detail": "COMPOUND QUERY"
  },
  {
    "id": 1328,
    "parent": 1327,
    "notused": 0,
    "detail": "LEFT-MOST SUBQUERY"
  },
  {
    "id": 1331,
    "parent": 1328,
    "notused": 0,
    "detail": "MATERIALIZE wanted_versions"
  },
  {
    "id": 1333,
    "parent": 1331,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 1343,
    "parent": 1328,
    "notused": 16,
    "detail": "SCAN wv_unt"
  },
  {
    "id": 1349,
    "parent": 1328,
    "notused": 61,
    "detail": "SEARCH unt USING INDEX idx_lix_internal_state_all_untracked_version_id (version_id=?)"
  },
  {
    "id": 1374,
    "parent": 1327,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1375,
    "parent": 1374,
    "notused": 0,
    "detail": "COMPOUND QUERY"
  },
  {
    "id": 1376,
    "parent": 1375,
    "notused": 0,
    "detail": "LEFT-MOST SUBQUERY"
  },
  {
    "id": 1381,
    "parent": 1376,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 1387,
    "parent": 1376,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_descriptor USING INDEX idx_lix_internal_state_cache_v1_lix_version_descriptor_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 1415,
    "parent": 1375,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1420,
    "parent": 1415,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 1426,
    "parent": 1415,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_stored_schema USING INDEX idx_lix_internal_state_cache_v1_lix_stored_schema_pk_version_id_json_extract_snapsho_json_extract_snapsho_r7zrf9 (version_id=?)"
  },
  {
    "id": 1454,
    "parent": 1375,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1459,
    "parent": 1454,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 1465,
    "parent": 1454,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_key_value USING INDEX idx_lix_internal_state_cache_v1_lix_key_value_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 1493,
    "parent": 1375,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1498,
    "parent": 1493,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 1504,
    "parent": 1493,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_active_account USING INDEX idx_lix_internal_state_cache_v1_lix_active_account_foreign_version_id_inherited_from_versi_json_extract_snapsho_79rox8 (version_id=?)"
  },
  {
    "id": 1532,
    "parent": 1375,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1537,
    "parent": 1532,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 1543,
    "parent": 1532,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit USING INDEX idx_lix_internal_state_cache_v1_lix_commit_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 1571,
    "parent": 1375,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1576,
    "parent": 1571,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 1582,
    "parent": 1571,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit_edge USING INDEX idx_lix_internal_state_cache_v1_lix_commit_edge_foreign_version_id_inherited_from_versi_json_extract_snapsho_79rox8 (version_id=?)"
  },
  {
    "id": 1610,
    "parent": 1375,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1615,
    "parent": 1610,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 1621,
    "parent": 1610,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_tip USING INDEX idx_lix_internal_state_cache_v1_lix_version_tip_unique_version_id_json_extract_snapsho_c3jqlx (version_id=?)"
  },
  {
    "id": 1649,
    "parent": 1375,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1654,
    "parent": 1649,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 1660,
    "parent": 1649,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 1688,
    "parent": 1375,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1693,
    "parent": 1688,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 1699,
    "parent": 1688,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set_element USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_element_foreign_version_id_inherited_from_versi_json_extract_snapsho_79rox8 (version_id=?)"
  },
  {
    "id": 1727,
    "parent": 1375,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1732,
    "parent": 1727,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 1738,
    "parent": 1727,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_label USING INDEX idx_lix_internal_state_cache_v1_lix_label_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 1766,
    "parent": 1375,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1771,
    "parent": 1766,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 1777,
    "parent": 1766,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_test_bench_diff_entity USING INDEX idx_lix_internal_state_cache_v1_test_bench_diff_entity_vfe (version_id=?)"
  },
  {
    "id": 1805,
    "parent": 1375,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1806,
    "parent": 1805,
    "notused": 0,
    "detail": "COMPOUND QUERY"
  },
  {
    "id": 1807,
    "parent": 1806,
    "notused": 0,
    "detail": "LEFT-MOST SUBQUERY"
  },
  {
    "id": 1809,
    "parent": 1807,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 1810,
    "parent": 1809,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 1820,
    "parent": 1807,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 1825,
    "parent": 1807,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_descriptor USING INDEX idx_lix_internal_state_cache_v1_lix_version_descriptor_live_vfe (version_id=?)"
  },
  {
    "id": 1835,
    "parent": 1807,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 1861,
    "parent": 1806,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1863,
    "parent": 1861,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 1864,
    "parent": 1863,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 1874,
    "parent": 1861,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 1879,
    "parent": 1861,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_stored_schema USING INDEX idx_lix_internal_state_cache_v1_lix_stored_schema_live_vfe (version_id=?)"
  },
  {
    "id": 1889,
    "parent": 1861,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 1915,
    "parent": 1806,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1917,
    "parent": 1915,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 1918,
    "parent": 1917,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 1928,
    "parent": 1915,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 1933,
    "parent": 1915,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_key_value USING INDEX idx_lix_internal_state_cache_v1_lix_key_value_live_vfe (version_id=?)"
  },
  {
    "id": 1943,
    "parent": 1915,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 1969,
    "parent": 1806,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 1971,
    "parent": 1969,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 1972,
    "parent": 1971,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 1982,
    "parent": 1969,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 1987,
    "parent": 1969,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_active_account USING INDEX idx_lix_internal_state_cache_v1_lix_active_account_live_vfe (version_id=?)"
  },
  {
    "id": 1997,
    "parent": 1969,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 2023,
    "parent": 1806,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 2025,
    "parent": 2023,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 2026,
    "parent": 2025,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 2036,
    "parent": 2023,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 2041,
    "parent": 2023,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit USING INDEX idx_lix_internal_state_cache_v1_lix_commit_live_vfe (version_id=?)"
  },
  {
    "id": 2051,
    "parent": 2023,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 2077,
    "parent": 1806,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 2079,
    "parent": 2077,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 2080,
    "parent": 2079,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 2090,
    "parent": 2077,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 2095,
    "parent": 2077,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit_edge USING INDEX idx_lix_internal_state_cache_v1_lix_commit_edge_live_vfe (version_id=?)"
  },
  {
    "id": 2105,
    "parent": 2077,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 2131,
    "parent": 1806,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 2133,
    "parent": 2131,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 2134,
    "parent": 2133,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 2144,
    "parent": 2131,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 2149,
    "parent": 2131,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_tip USING INDEX idx_lix_internal_state_cache_v1_lix_version_tip_live_vfe (version_id=?)"
  },
  {
    "id": 2159,
    "parent": 2131,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 2185,
    "parent": 1806,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 2187,
    "parent": 2185,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 2188,
    "parent": 2187,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 2198,
    "parent": 2185,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 2203,
    "parent": 2185,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_live_vfe (version_id=?)"
  },
  {
    "id": 2213,
    "parent": 2185,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 2239,
    "parent": 1806,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 2241,
    "parent": 2239,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 2242,
    "parent": 2241,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 2252,
    "parent": 2239,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 2257,
    "parent": 2239,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set_element USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_element_live_vfe (version_id=?)"
  },
  {
    "id": 2267,
    "parent": 2239,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 2293,
    "parent": 1806,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 2295,
    "parent": 2293,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 2296,
    "parent": 2295,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 2306,
    "parent": 2293,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 2311,
    "parent": 2293,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_label USING INDEX idx_lix_internal_state_cache_v1_lix_label_live_vfe (version_id=?)"
  },
  {
    "id": 2321,
    "parent": 2293,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 2347,
    "parent": 1806,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 2349,
    "parent": 2347,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 2350,
    "parent": 2349,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 2360,
    "parent": 2347,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 2365,
    "parent": 2347,
    "notused": 24,
    "detail": "SEARCH lix_internal_state_cache_v1_test_bench_diff_entity USING INDEX idx_lix_internal_state_cache_v1_test_bench_diff_entity_live_vfe (version_id=?)"
  },
  {
    "id": 2375,
    "parent": 2347,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 2401,
    "parent": 1806,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 2403,
    "parent": 2401,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 2404,
    "parent": 2403,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 2414,
    "parent": 2401,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 2419,
    "parent": 2401,
    "notused": 61,
    "detail": "SEARCH unt USING INDEX idx_lix_internal_state_all_untracked_version_id (version_id=?)"
  },
  {
    "id": 2432,
    "parent": 2401,
    "notused": 0,
    "detail": "BLOOM FILTER ON wv_vi (version_id=?)"
  },
  {
    "id": 2444,
    "parent": 2401,
    "notused": 53,
    "detail": "SEARCH wv_vi USING AUTOMATIC PARTIAL COVERING INDEX (version_id=?)"
  },
  {
    "id": 2473,
    "parent": 1375,
    "notused": 263,
    "detail": "SCAN c"
  },
  {
    "id": 2512,
    "parent": 1375,
    "notused": 0,
    "detail": "USE TEMP B-TREE FOR ORDER BY"
  },
  {
    "id": 2552,
    "parent": 1374,
    "notused": 243,
    "detail": "SCAN (subquery-99)"
  },
  {
    "id": 2637,
    "parent": 1327,
    "notused": 243,
    "detail": "SCAN w"
  },
  {
    "id": 2646,
    "parent": 1327,
    "notused": 45,
    "detail": "SEARCH ws_dst USING PRIMARY KEY (file_id=? AND version_id=? AND entity_id=? AND schema_key=?) LEFT-JOIN"
  },
  {
    "id": 2659,
    "parent": 1327,
    "notused": 45,
    "detail": "SEARCH ws_src USING PRIMARY KEY (file_id=? AND version_id=? AND entity_id=? AND schema_key=?) LEFT-JOIN"
  },
  {
    "id": 2698,
    "parent": 1326,
    "notused": 243,
    "detail": "SCAN w"
  },
  {
    "id": 2709,
    "parent": 1326,
    "notused": 0,
    "detail": "BLOOM FILTER ON lix_internal_state_vtable (version_id=? AND entity_id=? AND schema_key=? AND file_id=?)"
  },
  {
    "id": 2737,
    "parent": 1326,
    "notused": 53,
    "detail": "SEARCH lix_internal_state_vtable USING AUTOMATIC PARTIAL COVERING INDEX (version_id=? AND entity_id=? AND schema_key=? AND file_id=?) LEFT-JOIN"
  },
  {
    "id": 2818,
    "parent": 1324,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 2820,
    "parent": 2818,
    "notused": 0,
    "detail": "CO-ROUTINE w"
  },
  {
    "id": 2823,
    "parent": 2820,
    "notused": 0,
    "detail": "CO-ROUTINE (subquery-120)"
  },
  {
    "id": 2825,
    "parent": 2823,
    "notused": 0,
    "detail": "CO-ROUTINE c"
  },
  {
    "id": 2826,
    "parent": 2825,
    "notused": 0,
    "detail": "COMPOUND QUERY"
  },
  {
    "id": 2827,
    "parent": 2826,
    "notused": 0,
    "detail": "LEFT-MOST SUBQUERY"
  },
  {
    "id": 2830,
    "parent": 2827,
    "notused": 0,
    "detail": "MATERIALIZE wanted_versions"
  },
  {
    "id": 2832,
    "parent": 2830,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 2842,
    "parent": 2827,
    "notused": 16,
    "detail": "SCAN wv_unt"
  },
  {
    "id": 2848,
    "parent": 2827,
    "notused": 61,
    "detail": "SEARCH unt USING INDEX idx_lix_internal_state_all_untracked_version_id (version_id=?)"
  },
  {
    "id": 2873,
    "parent": 2826,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 2874,
    "parent": 2873,
    "notused": 0,
    "detail": "COMPOUND QUERY"
  },
  {
    "id": 2875,
    "parent": 2874,
    "notused": 0,
    "detail": "LEFT-MOST SUBQUERY"
  },
  {
    "id": 2880,
    "parent": 2875,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 2886,
    "parent": 2875,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_descriptor USING INDEX idx_lix_internal_state_cache_v1_lix_version_descriptor_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 2914,
    "parent": 2874,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 2919,
    "parent": 2914,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 2925,
    "parent": 2914,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_stored_schema USING INDEX idx_lix_internal_state_cache_v1_lix_stored_schema_pk_version_id_json_extract_snapsho_json_extract_snapsho_r7zrf9 (version_id=?)"
  },
  {
    "id": 2953,
    "parent": 2874,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 2958,
    "parent": 2953,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 2964,
    "parent": 2953,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_key_value USING INDEX idx_lix_internal_state_cache_v1_lix_key_value_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 2992,
    "parent": 2874,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 2997,
    "parent": 2992,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 3003,
    "parent": 2992,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_active_account USING INDEX idx_lix_internal_state_cache_v1_lix_active_account_foreign_version_id_inherited_from_versi_json_extract_snapsho_79rox8 (version_id=?)"
  },
  {
    "id": 3031,
    "parent": 2874,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3036,
    "parent": 3031,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 3042,
    "parent": 3031,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit USING INDEX idx_lix_internal_state_cache_v1_lix_commit_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 3070,
    "parent": 2874,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3075,
    "parent": 3070,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 3081,
    "parent": 3070,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit_edge USING INDEX idx_lix_internal_state_cache_v1_lix_commit_edge_foreign_version_id_inherited_from_versi_json_extract_snapsho_79rox8 (version_id=?)"
  },
  {
    "id": 3109,
    "parent": 2874,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3114,
    "parent": 3109,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 3120,
    "parent": 3109,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_tip USING INDEX idx_lix_internal_state_cache_v1_lix_version_tip_unique_version_id_json_extract_snapsho_c3jqlx (version_id=?)"
  },
  {
    "id": 3148,
    "parent": 2874,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3153,
    "parent": 3148,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 3159,
    "parent": 3148,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 3187,
    "parent": 2874,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3192,
    "parent": 3187,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 3198,
    "parent": 3187,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set_element USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_element_foreign_version_id_inherited_from_versi_json_extract_snapsho_79rox8 (version_id=?)"
  },
  {
    "id": 3226,
    "parent": 2874,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3231,
    "parent": 3226,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 3237,
    "parent": 3226,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_label USING INDEX idx_lix_internal_state_cache_v1_lix_label_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 3265,
    "parent": 2874,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3270,
    "parent": 3265,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 3276,
    "parent": 3265,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_test_bench_diff_entity USING INDEX idx_lix_internal_state_cache_v1_test_bench_diff_entity_vfe (version_id=?)"
  },
  {
    "id": 3304,
    "parent": 2874,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3305,
    "parent": 3304,
    "notused": 0,
    "detail": "COMPOUND QUERY"
  },
  {
    "id": 3306,
    "parent": 3305,
    "notused": 0,
    "detail": "LEFT-MOST SUBQUERY"
  },
  {
    "id": 3308,
    "parent": 3306,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 3309,
    "parent": 3308,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 3319,
    "parent": 3306,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 3324,
    "parent": 3306,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_descriptor USING INDEX idx_lix_internal_state_cache_v1_lix_version_descriptor_live_vfe (version_id=?)"
  },
  {
    "id": 3334,
    "parent": 3306,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 3360,
    "parent": 3305,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3362,
    "parent": 3360,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 3363,
    "parent": 3362,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 3373,
    "parent": 3360,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 3378,
    "parent": 3360,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_stored_schema USING INDEX idx_lix_internal_state_cache_v1_lix_stored_schema_live_vfe (version_id=?)"
  },
  {
    "id": 3388,
    "parent": 3360,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 3414,
    "parent": 3305,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3416,
    "parent": 3414,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 3417,
    "parent": 3416,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 3427,
    "parent": 3414,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 3432,
    "parent": 3414,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_key_value USING INDEX idx_lix_internal_state_cache_v1_lix_key_value_live_vfe (version_id=?)"
  },
  {
    "id": 3442,
    "parent": 3414,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 3468,
    "parent": 3305,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3470,
    "parent": 3468,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 3471,
    "parent": 3470,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 3481,
    "parent": 3468,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 3486,
    "parent": 3468,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_active_account USING INDEX idx_lix_internal_state_cache_v1_lix_active_account_live_vfe (version_id=?)"
  },
  {
    "id": 3496,
    "parent": 3468,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 3522,
    "parent": 3305,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3524,
    "parent": 3522,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 3525,
    "parent": 3524,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 3535,
    "parent": 3522,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 3540,
    "parent": 3522,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit USING INDEX idx_lix_internal_state_cache_v1_lix_commit_live_vfe (version_id=?)"
  },
  {
    "id": 3550,
    "parent": 3522,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 3576,
    "parent": 3305,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3578,
    "parent": 3576,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 3579,
    "parent": 3578,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 3589,
    "parent": 3576,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 3594,
    "parent": 3576,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit_edge USING INDEX idx_lix_internal_state_cache_v1_lix_commit_edge_live_vfe (version_id=?)"
  },
  {
    "id": 3604,
    "parent": 3576,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 3630,
    "parent": 3305,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3632,
    "parent": 3630,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 3633,
    "parent": 3632,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 3643,
    "parent": 3630,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 3648,
    "parent": 3630,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_tip USING INDEX idx_lix_internal_state_cache_v1_lix_version_tip_live_vfe (version_id=?)"
  },
  {
    "id": 3658,
    "parent": 3630,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 3684,
    "parent": 3305,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3686,
    "parent": 3684,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 3687,
    "parent": 3686,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 3697,
    "parent": 3684,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 3702,
    "parent": 3684,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_live_vfe (version_id=?)"
  },
  {
    "id": 3712,
    "parent": 3684,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 3738,
    "parent": 3305,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3740,
    "parent": 3738,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 3741,
    "parent": 3740,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 3751,
    "parent": 3738,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 3756,
    "parent": 3738,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set_element USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_element_live_vfe (version_id=?)"
  },
  {
    "id": 3766,
    "parent": 3738,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 3792,
    "parent": 3305,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3794,
    "parent": 3792,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 3795,
    "parent": 3794,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 3805,
    "parent": 3792,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 3810,
    "parent": 3792,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_label USING INDEX idx_lix_internal_state_cache_v1_lix_label_live_vfe (version_id=?)"
  },
  {
    "id": 3820,
    "parent": 3792,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 3846,
    "parent": 3305,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3848,
    "parent": 3846,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 3849,
    "parent": 3848,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 3859,
    "parent": 3846,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 3864,
    "parent": 3846,
    "notused": 24,
    "detail": "SEARCH lix_internal_state_cache_v1_test_bench_diff_entity USING INDEX idx_lix_internal_state_cache_v1_test_bench_diff_entity_live_vfe (version_id=?)"
  },
  {
    "id": 3874,
    "parent": 3846,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 3900,
    "parent": 3305,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 3902,
    "parent": 3900,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 3903,
    "parent": 3902,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 3913,
    "parent": 3900,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 3918,
    "parent": 3900,
    "notused": 61,
    "detail": "SEARCH unt USING INDEX idx_lix_internal_state_all_untracked_version_id (version_id=?)"
  },
  {
    "id": 3931,
    "parent": 3900,
    "notused": 0,
    "detail": "BLOOM FILTER ON wv_vi (version_id=?)"
  },
  {
    "id": 3943,
    "parent": 3900,
    "notused": 53,
    "detail": "SEARCH wv_vi USING AUTOMATIC PARTIAL COVERING INDEX (version_id=?)"
  },
  {
    "id": 3972,
    "parent": 2874,
    "notused": 263,
    "detail": "SCAN c"
  },
  {
    "id": 4011,
    "parent": 2874,
    "notused": 0,
    "detail": "USE TEMP B-TREE FOR ORDER BY"
  },
  {
    "id": 4051,
    "parent": 2873,
    "notused": 243,
    "detail": "SCAN (subquery-120)"
  },
  {
    "id": 4135,
    "parent": 2826,
    "notused": 0,
    "detail": "MATERIALIZE lix_internal_state_vtable"
  },
  {
    "id": 4137,
    "parent": 4135,
    "notused": 0,
    "detail": "CO-ROUTINE w"
  },
  {
    "id": 4140,
    "parent": 4137,
    "notused": 0,
    "detail": "CO-ROUTINE (subquery-141)"
  },
  {
    "id": 4142,
    "parent": 4140,
    "notused": 0,
    "detail": "CO-ROUTINE c"
  },
  {
    "id": 4143,
    "parent": 4142,
    "notused": 0,
    "detail": "COMPOUND QUERY"
  },
  {
    "id": 4144,
    "parent": 4143,
    "notused": 0,
    "detail": "LEFT-MOST SUBQUERY"
  },
  {
    "id": 4147,
    "parent": 4144,
    "notused": 0,
    "detail": "MATERIALIZE wanted_versions"
  },
  {
    "id": 4149,
    "parent": 4147,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 4159,
    "parent": 4144,
    "notused": 16,
    "detail": "SCAN wv_unt"
  },
  {
    "id": 4165,
    "parent": 4144,
    "notused": 61,
    "detail": "SEARCH unt USING INDEX idx_lix_internal_state_all_untracked_version_id (version_id=?)"
  },
  {
    "id": 4190,
    "parent": 4143,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4191,
    "parent": 4190,
    "notused": 0,
    "detail": "COMPOUND QUERY"
  },
  {
    "id": 4192,
    "parent": 4191,
    "notused": 0,
    "detail": "LEFT-MOST SUBQUERY"
  },
  {
    "id": 4197,
    "parent": 4192,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 4203,
    "parent": 4192,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_descriptor USING INDEX idx_lix_internal_state_cache_v1_lix_version_descriptor_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 4231,
    "parent": 4191,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4236,
    "parent": 4231,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 4242,
    "parent": 4231,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_stored_schema USING INDEX idx_lix_internal_state_cache_v1_lix_stored_schema_pk_version_id_json_extract_snapsho_json_extract_snapsho_r7zrf9 (version_id=?)"
  },
  {
    "id": 4270,
    "parent": 4191,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4275,
    "parent": 4270,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 4281,
    "parent": 4270,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_key_value USING INDEX idx_lix_internal_state_cache_v1_lix_key_value_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 4309,
    "parent": 4191,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4314,
    "parent": 4309,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 4320,
    "parent": 4309,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_active_account USING INDEX idx_lix_internal_state_cache_v1_lix_active_account_foreign_version_id_inherited_from_versi_json_extract_snapsho_79rox8 (version_id=?)"
  },
  {
    "id": 4348,
    "parent": 4191,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4353,
    "parent": 4348,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 4359,
    "parent": 4348,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit USING INDEX idx_lix_internal_state_cache_v1_lix_commit_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 4387,
    "parent": 4191,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4392,
    "parent": 4387,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 4398,
    "parent": 4387,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit_edge USING INDEX idx_lix_internal_state_cache_v1_lix_commit_edge_foreign_version_id_inherited_from_versi_json_extract_snapsho_79rox8 (version_id=?)"
  },
  {
    "id": 4426,
    "parent": 4191,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4431,
    "parent": 4426,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 4437,
    "parent": 4426,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_tip USING INDEX idx_lix_internal_state_cache_v1_lix_version_tip_unique_version_id_json_extract_snapsho_c3jqlx (version_id=?)"
  },
  {
    "id": 4465,
    "parent": 4191,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4470,
    "parent": 4465,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 4476,
    "parent": 4465,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 4504,
    "parent": 4191,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4509,
    "parent": 4504,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 4515,
    "parent": 4504,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set_element USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_element_foreign_version_id_inherited_from_versi_json_extract_snapsho_79rox8 (version_id=?)"
  },
  {
    "id": 4543,
    "parent": 4191,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4548,
    "parent": 4543,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 4554,
    "parent": 4543,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_label USING INDEX idx_lix_internal_state_cache_v1_lix_label_pk_version_id_json_extract_snapsho_4h2kdb (version_id=?)"
  },
  {
    "id": 4582,
    "parent": 4191,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4587,
    "parent": 4582,
    "notused": 216,
    "detail": "SCAN wv_cache"
  },
  {
    "id": 4593,
    "parent": 4582,
    "notused": 62,
    "detail": "SEARCH lix_internal_state_cache_v1_test_bench_diff_entity USING INDEX idx_lix_internal_state_cache_v1_test_bench_diff_entity_vfe (version_id=?)"
  },
  {
    "id": 4621,
    "parent": 4191,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4622,
    "parent": 4621,
    "notused": 0,
    "detail": "COMPOUND QUERY"
  },
  {
    "id": 4623,
    "parent": 4622,
    "notused": 0,
    "detail": "LEFT-MOST SUBQUERY"
  },
  {
    "id": 4625,
    "parent": 4623,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 4626,
    "parent": 4625,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 4636,
    "parent": 4623,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 4641,
    "parent": 4623,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_descriptor USING INDEX idx_lix_internal_state_cache_v1_lix_version_descriptor_live_vfe (version_id=?)"
  },
  {
    "id": 4651,
    "parent": 4623,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 4677,
    "parent": 4622,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4679,
    "parent": 4677,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 4680,
    "parent": 4679,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 4690,
    "parent": 4677,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 4695,
    "parent": 4677,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_stored_schema USING INDEX idx_lix_internal_state_cache_v1_lix_stored_schema_live_vfe (version_id=?)"
  },
  {
    "id": 4705,
    "parent": 4677,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 4731,
    "parent": 4622,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4733,
    "parent": 4731,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 4734,
    "parent": 4733,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 4744,
    "parent": 4731,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 4749,
    "parent": 4731,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_key_value USING INDEX idx_lix_internal_state_cache_v1_lix_key_value_live_vfe (version_id=?)"
  },
  {
    "id": 4759,
    "parent": 4731,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 4785,
    "parent": 4622,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4787,
    "parent": 4785,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 4788,
    "parent": 4787,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 4798,
    "parent": 4785,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 4803,
    "parent": 4785,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_active_account USING INDEX idx_lix_internal_state_cache_v1_lix_active_account_live_vfe (version_id=?)"
  },
  {
    "id": 4813,
    "parent": 4785,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 4839,
    "parent": 4622,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4841,
    "parent": 4839,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 4842,
    "parent": 4841,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 4852,
    "parent": 4839,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 4857,
    "parent": 4839,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit USING INDEX idx_lix_internal_state_cache_v1_lix_commit_live_vfe (version_id=?)"
  },
  {
    "id": 4867,
    "parent": 4839,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 4893,
    "parent": 4622,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4895,
    "parent": 4893,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 4896,
    "parent": 4895,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 4906,
    "parent": 4893,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 4911,
    "parent": 4893,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_commit_edge USING INDEX idx_lix_internal_state_cache_v1_lix_commit_edge_live_vfe (version_id=?)"
  },
  {
    "id": 4921,
    "parent": 4893,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 4947,
    "parent": 4622,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 4949,
    "parent": 4947,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 4950,
    "parent": 4949,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 4960,
    "parent": 4947,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 4965,
    "parent": 4947,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_version_tip USING INDEX idx_lix_internal_state_cache_v1_lix_version_tip_live_vfe (version_id=?)"
  },
  {
    "id": 4975,
    "parent": 4947,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 5001,
    "parent": 4622,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 5003,
    "parent": 5001,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 5004,
    "parent": 5003,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 5014,
    "parent": 5001,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 5019,
    "parent": 5001,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_live_vfe (version_id=?)"
  },
  {
    "id": 5029,
    "parent": 5001,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 5055,
    "parent": 4622,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 5057,
    "parent": 5055,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 5058,
    "parent": 5057,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 5068,
    "parent": 5055,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 5073,
    "parent": 5055,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_change_set_element USING INDEX idx_lix_internal_state_cache_v1_lix_change_set_element_live_vfe (version_id=?)"
  },
  {
    "id": 5083,
    "parent": 5055,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 5109,
    "parent": 4622,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 5111,
    "parent": 5109,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 5112,
    "parent": 5111,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 5122,
    "parent": 5109,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 5127,
    "parent": 5109,
    "notused": 27,
    "detail": "SEARCH lix_internal_state_cache_v1_lix_label USING INDEX idx_lix_internal_state_cache_v1_lix_label_live_vfe (version_id=?)"
  },
  {
    "id": 5137,
    "parent": 5109,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 5163,
    "parent": 4622,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 5165,
    "parent": 5163,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 5166,
    "parent": 5165,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 5176,
    "parent": 5163,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 5181,
    "parent": 5163,
    "notused": 24,
    "detail": "SEARCH lix_internal_state_cache_v1_test_bench_diff_entity USING INDEX idx_lix_internal_state_cache_v1_test_bench_diff_entity_live_vfe (version_id=?)"
  },
  {
    "id": 5191,
    "parent": 5163,
    "notused": 216,
    "detail": "SCAN wv_vi"
  },
  {
    "id": 5217,
    "parent": 4622,
    "notused": 0,
    "detail": "UNION ALL"
  },
  {
    "id": 5219,
    "parent": 5217,
    "notused": 0,
    "detail": "CO-ROUTINE vi"
  },
  {
    "id": 5220,
    "parent": 5219,
    "notused": 0,
    "detail": "SCAN CONSTANT ROW"
  },
  {
    "id": 5230,
    "parent": 5217,
    "notused": 16,
    "detail": "SCAN vi"
  },
  {
    "id": 5235,
    "parent": 5217,
    "notused": 61,
    "detail": "SEARCH unt USING INDEX idx_lix_internal_state_all_untracked_version_id (version_id=?)"
  },
  {
    "id": 5248,
    "parent": 5217,
    "notused": 0,
    "detail": "BLOOM FILTER ON wv_vi (version_id=?)"
  },
  {
    "id": 5260,
    "parent": 5217,
    "notused": 53,
    "detail": "SEARCH wv_vi USING AUTOMATIC PARTIAL COVERING INDEX (version_id=?)"
  },
  {
    "id": 5289,
    "parent": 4191,
    "notused": 263,
    "detail": "SCAN c"
  },
  {
    "id": 5328,
    "parent": 4191,
    "notused": 0,
    "detail": "USE TEMP B-TREE FOR ORDER BY"
  },
  {
    "id": 5368,
    "parent": 4190,
    "notused": 243,
    "detail": "SCAN (subquery-141)"
  },
  {
    "id": 5453,
    "parent": 4143,
    "notused": 243,
    "detail": "SCAN w"
  },
  {
    "id": 5460,
    "parent": 4143,
    "notused": 45,
    "detail": "SEARCH ws_dst USING PRIMARY KEY (file_id=? AND version_id=? AND entity_id=? AND schema_key=?) LEFT-JOIN"
  },
  {
    "id": 5473,
    "parent": 4143,
    "notused": 45,
    "detail": "SEARCH ws_src USING PRIMARY KEY (file_id=? AND version_id=? AND entity_id=? AND schema_key=?) LEFT-JOIN"
  },
  {
    "id": 5512,
    "parent": 4142,
    "notused": 243,
    "detail": "SCAN w"
  },
  {
    "id": 5525,
    "parent": 4142,
    "notused": 0,
    "detail": "BLOOM FILTER ON lix_internal_state_vtable (version_id=? AND entity_id=? AND schema_key=? AND file_id=?)"
  },
  {
    "id": 5551,
    "parent": 4142,
    "notused": 53,
    "detail": "SEARCH lix_internal_state_vtable USING AUTOMATIC PARTIAL COVERING INDEX (version_id=? AND entity_id=? AND schema_key=? AND file_id=?) LEFT-JOIN"
  }
]